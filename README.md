# 量化整体介绍

## 量化基本框架

![image](https://cdn.staticaly.com/gh/neowei1987/blog_assets@main/image.4o0gomd86nc0.webp)


### 量化投资模式介绍

![image](https://cdn.staticaly.com/gh/neowei1987/blog_assets@main/image.6nj3lw26pes0.webp)

### 量化中有哪些模型【静态视角】

![image](https://cdn.staticaly.com/gh/neowei1987/blog_assets@main/image.4bfq4tz0mq80.webp)

- 风险模型：最坏情况下不至于破产
- 成本模型：显性成本（印花税）、隐形成本（股指对冲时升水、贴水）
- 组合构建：在追求利润、控制风险与交易成本之间进行平衡
- 交易执行：综合考虑流动性，高效率低成本选择交易执行方式

### 量化交易流程【动态视角】

![image](https://cdn.staticaly.com/gh/neowei1987/blog_assets@main/image.1vzqebknxhvk.webp)

### 交易理论

#### 有效市场假说

有效市场假说：解释了通过股票交易是不可能获利的

#### 行为金融学

人性中对于获利的贪婪和对于损失的恐惧，是豆古不变的

禀赋效应

人们在决策过程中对利和害的权衡是不均衡的，对“**避害**”的考虑远大于对“趋利”的考虑

跨期选择

人类恰恰是不擅长做跨期决策的，大多数时候会做出**短视冲动**的选择

心理账户&储蓄理论

人在思考问题时，会在心里构建出分门别类的心理账户，分别进行计算

在个股方面，寻找预示了投资者非理性行为的事件。

由两种错误带来的买入机会： 反应过度、反应不足

两种赚钱机会：

1. 市场在某一特定时间内的无效性，或者说是别人犯的错误
2. 主动承担某种特定风险，继而获得承担该风险的风险溢价

例如股票你想买，他想卖，后来股票涨了。 这就说明，市场当时是无效的。
也就是说，别人犯错了，你就赚钱了。

不要做普通人！！

底层逻辑

![企业微信截图_30b9bf9f-a7d2-4bb0-b111-9d9cce46cc9b](https://cdn.staticaly.com/gh/neowei1987/blog_assets@main/企业微信截图_30b9bf9f-a7d2-4bb0-b111-9d9cce46cc9b.2i0yj8xer340.webp)
三类交易机会：
趋势回调，
趋势突破，动量性策略
反转：超卖，定价偏离。

回调，突破，反转。

（1）出场alpha， 择时alpha, 条件alpha  ===> 轻仓顺势 
（2）周期放小，都是趋势；周期放大，都是震荡；
（3）三种基本形态：趋势反转、趋势回调、趋势突破
（4）两种效应：钟摆效应（由于交易者的非理性，使得价格经常会偏离公允价格，也就是会围绕着公允价格上下波动）、波动效应（公允价格发生变化）
（4）插针行情：在一段时间的震荡之后，行情向下成功突破，然后迅速向下，然后突然掉头，行情又直接向上。
	上年走势的目的在于：洗盘，把不坚定的做多者洗掉；减少自己拉升时，可能遇到的阻力。
	主力做法：吸纳一部分筹码（尽量少，但是要足够，足够把价格打下去）； 然后一直卖空，价格拉低… 
	然后，再价格较低的时候，进一步吸纳新的筹码，一遍拉升，一遍偷偷的出货，让散伙高位站岗。或者让散伙暴露在空军的枪口之下。


反转 
单一周期下，反转往往在波动的中下区间，也就意味着反转本身，带有一定的后验alpha和位置优势，所以应当适当放大止损，去覆盖后验alpha.
要看更高周期的止盈，去追求更多。

突破策略
突破往往在波动的顶部区域，突破本身就带有择时效应，

### 一个交易系统的要素

在什么市场，卖卖什么，卖卖多少，什么时间买卖；

统计自己策略的胜率，根据自己的**胜率**，
在期望收益为正的前提下，设定自己的**盈亏比**

止损分为分钟：

1. 硬性止损： 这个位置是风险系统得出的（根据总资金控制、持仓股数量上限 、单只股票持仓限制、头寸分配策略等）
2. 软性止损：位置是根据K线形态推导出来的

资金量的大小

头寸规模的确定：买卖多少
    重点：**仓位控制**！！

#### 你选择在哪个市场做交易，卖卖什么品种

必要条件：
    跨市场、高流动性！！最基本！！

不同的交易品种，有不同的**波动率**，波动率越大，市场风险就越大。

每一个入场点，都有相对应的涨跌空间，这个意思是说，你入场之后，他能涨多少，他可能会跌多少？
涨跟跌的过程中，会不会遇到**支撑位、压力位**？

突破支撑位的可能性是多少？ 突破压力位的概率是多少？ 在相应点位形成震荡的概率又是多少？

### 交易计划

背景
2018年1月17日，买入东方财富300059，成本13.2，数量100手
退出计划
√持仓截至时间为2018年2月26日
√止盈：14.4平仓50%，15.5清仓
√止损：12.3平仓50%，12元清仓

盈利目标
策略模型
量化回测
严格执行

## 仓位控制

交易机会的多少
    
交易成本
    手续费、滑点

仓位、出场策略 很重要！

其他细节：
 、复利｜不复利 、


### 量化子系统介绍

#### kafka系统的应用场景

（1）行情数据的分发

交易所的数据，经过处理之后，投递到queue，供其他子系统使用。

（2）模拟盘数据流

为了提升系统的运行效率，降低耦合，提高复用程 度，系统划分为条件计算、选股、交易决策、撮合、
账户等多个子系统。这些系统之间通过Kafka串成一 个回测/模拟盘的处理流水线。

行情数据 生产了 行情数据，供 撮合、交易决策、条件计算 （consume)

条件计算 生产了 选股条件 ===》 选股子系统 ===》 被选中股票 ==》 交易决策 ===》 委托单 =》 撮合子系统 ==》 成交信息 ==》 账户

（3）任务触发器


---


股票池 + 择时信号 策略基础

一个基本合格里的例子 ：买上证50中，最近突破5日均线的股票

股票池中，选择要开始发力的信号！

从优质股票的集合中，选择近期开始发力上涨的股票！！

退出机制：什么时候卖，兼顾收益和风险

![image](https://cdn.staticaly.com/gh/neowei1987/blog_assets@main/image.59a4ax7mldc0.webp)

## 方法论

你围绕什么做交易？你交易的是你的观点，而不是市场

量价时空是你的全部观察（变量）吗？

### 量价时空

- 量 供应和需求投入的兵力
- 价 供应和需求当前的强弱
- 时 供应和需求拉锯的过程长度
- 空 供应和需求战场的广阔程度

如果不是，还需要什么？

供需关系
趋势的动力来自于供需关系的不平衡； 力量与质量

因果关系
趋势形成之前需要准备过程
过程、时空

横盘整理，是积蓄力量的表现。

跳空下跌，非常危险。

### 压力支撑

#### 压力与支撑不是什么

均线？
筹码分布？ 
关键价位

#### 压力支撑是什么

压力
·某个价位抛售力量超过了购买力；供应超过了需求 
当价格再次回到压力位价格回落力度表明供应是否扩大

支撑
在某个价位购买力超过了抛售压力需求吸收了全部供应
当价格再次回到支撑位反弹力度表明需求质量

### 努力与结果
成交量的增长没有使价格大幅增长，这是走势停止行为
显性和隐性

典型的停止行为（一）：努力与结果的不匹配
放量的长 上影线/下影线

随着成交量的放大，需求的努力，没有取得相应的结果（价格没有进一步上涨）
==》 有新增的供应入场，后续会如何发展呢？
三种可能：
（1）短暂整理后，价格继续上涨【暂时供应，散户在供应】
（2）震荡整理，价格下跌（主力开始派发了）
（3）不经过任何整理，直接下跌（不计成本，直接抛售）

随着成交量的放大，供应的努力，没有取得相应的结果（价格没有进一步下跌）
==》 有新增的需求入场，
三种可能：
（1）短暂整理后，价格继续下跌【暂时供应】
（2）震荡整理，价格上涨（主力开始派发了）
（3）不经过任何整理，直接上涨（不计成本，直接抛售）

---


投资哲学： 理论驱动（都给出一个解释！分析因果）、数据驱动（挖掘数据，分析相关性）

投资流派

数学模型可以复杂，也可以简单
定投、人工智能、无高下、围棋、80年代、图书馆
可以自动交易，可以不自动交易
手工交易可以是量化、有的自动交易却不是量化
〉有价格曲线的品种，都能量化交易
房产
交易玩法众多
高频交易、套利、趋势等


工程实现考虑

保证金不足时的处理：
（1）限制新的购买，忽略该信号
（2）在增加新股票之前，消除业绩最差的头寸
（2）为继续购买新的，将头寸规模确定得小一些

入选组合的优先级
    排序指标（其他独立指标，例如基本面数据）
    历史表现
时间维度上的考虑
    单日新增仓位限制（因为大盘大概率同涨同跌，导致信号同时发出）

====

复利的要点

一个期望收益为正的交易系统
严控每期投资收益的回撤，尤其要避免“连续的”亏损【避免大的回撤！】
持之以恒

禁忌：大起大落、重仓加杠杆

## 交易基本概念

### 集合竞价

集合竞价，是指每天开盘前，交易所主机接受入市者申报的买卖指令按价格优先和时间优先的原则计算
各价位的成交量，最后以最大成交 量的价格作为集合竞价的成交价 这个集合竞价的成交价就是该股的
开盘价；而这个过程就被称为集合 竞价 集合竞价期间（09：15-09：30）各个时间段的动作和限制见左图。

### 除权/除息、复权

![image](https://cdn.staticaly.com/gh/neowei1987/blog_assets@main/image.2h23pj42n600.webp)

复权因子的定义

![image](https://cdn.staticaly.com/gh/neowei1987/blog_assets@main/image.2cqtpl4jzhz4.webp)
复权的意义：
指标不失真：无异常跳动点、波动区间连续
回测不出错：逻辑框架简单、持仓数量一致

![image](https://cdn.staticaly.com/gh/neowei1987/blog_assets@main/image.65m5sngmhd80.webp)

解决方案：
1.读取回测区间的行情数据，并一次 性地对所有交易日做前复权处理
2.逐日地对当天价格和前N日价格（共 N+1天）重新做前复权处理
3.采用后复权方案

### 打新

### 配股

股东有资格低价买入股票，一种融资手段；
会除权
